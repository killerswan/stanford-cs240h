*Main> mutualIntersectRect (coordsToRect "0,0,65536,65536,1,1,1,1") (coordsToRect "1965,6375,1965,6350,2509,6350,2509,6375")
True



*Main> rects <- readFile "rects.txt"
*Main> let rs = lines rects
*Main> head rs
"5391,8260,5391,8216,5357,8216,5357,8260"
*Main> 




*Main> let inBounds = mutualIntersectRect (Rect (Pt 0 0) (Pt 65535 65535))
*Main> let rsBounds = map (inBounds . coordsToRect) rs


*Main> length $ filter (==False) rsBounds 
0
*Main> length $ filter (==True) rsBounds 
1454



*Main> hrtFromCoordList rs
Root (Branch (Rect (Pt 476 965) (Pt 7752 7926)) (LHV 3406177) [Branch (Rect (Pt 1965 6262) (Pt 4233 7926)) (LHV 3161048) [Branch (Rect (Pt 1965 6262) (Pt 4233 7926)) (LHV 3156407) [Branch (Rect (Pt 1965 6350) (Pt 4233 7149)) (LHV 3151353) [Branch (Rect (Pt 1965 6350) (Pt 4233 7149)) (LHV 3151353) [Branch (Rect (Pt 1965 6350) (Pt 4233 6971)) (LHV 3151353) [Leaf (Rect (Pt 1965 6350) (Pt 4233 6971)) (LHV 3151353) [Info (Rect (Pt 1965 6350) (Pt 2509 6375)) (LHV 3151353) "1965,6375,1965,6350,2509,6350,2509,6375",Info (Rect (Pt 3536 6530) (Pt 3760 6555)) (LHV 3149443) "3536,6555,3536,6530,3760,6530,3760,6555",Info (Rect (Pt 3888 6937) (Pt 4233 6971)) (LHV 3148487) "4233,6937,4233,6971,3888,6971,3888,6937"],Leaf (Rect (Pt 2844 6440) (Pt 2992 6464)) (LHV 3150372) [Info (Rect (Pt 2844 6440) (Pt 2992 6464)) (LHV 3150372) "2844,6464,2844,6440,2992,6440,2992,6464"],Leaf (Rect (Pt 3031 6435) (Pt 3420 6459)) (LHV 3145838) [Info (Rect (Pt 3031 6435) (Pt 3420 6459)) (LHV 3145838) "3031,6459,3031,6435,3420,6435,3420,6459"]],Branch (Rect (Pt 2541 6390) (Pt 2780 6417)) (LHV 3150123) [Leaf (Rect (Pt 2541 6390) (Pt 2780 6417)) (LHV 3150123) [Info (Rect (Pt 2541 6390) (Pt 2780 6417)) (LHV 3150123) "2541,6417,2541,6390,2780,6390,2780,6417"]],Branch (Rect (Pt 3406 7123) (Pt 4113 7149)) (LHV 3148190) [Leaf (Rect (Pt 3406 7123) (Pt 4113 7149)) (LHV 3148190) [Info (Rect (Pt 3406 7123) (Pt 4113 7149)) (LHV 3148190) "4113,7123,4113,7149,3406,7149,3406,7123"]]],Branch (Rect (Pt 2528 6526) (Pt 2681 6558)) (LHV 3150155) [Branch (Rect (Pt 2528 6526) (Pt 2681 6558)) (LHV 3150155) [Leaf (Rect (Pt 2528 6526) (Pt 2681 6558)) (LHV 3150155) [Info (Rect (Pt 2528 6526) (Pt 2681 6558)) (LHV 3150155) "2528,6558,2528,6526,2681,6526,2681,6558"]]],Branch (Rect (Pt 3048 6947) (Pt 3793 6971)) (LHV 3147297) [Branch (Rect (Pt 3048 6947) (Pt 3793 6971)) (LHV 3147297) [Leaf (Rect (Pt 3048 6947) (Pt 3793 6971)) (LHV 3147297) [Info (Rect (Pt 3048 6947) (Pt 3793 6971)) (LHV 3147297) "3048,6971,3048,6947,3793,6947,3793,6971"]]]],Branch (Rect (Pt 2074 6391) (Pt 2479 7926)) (LHV 3156407) [Branch (Rect (Pt 2074 6391) (Pt 2479 7926)) (LHV 3156407) [Branch (Rect (Pt 2074 6391) (Pt 2479 7926)) (LHV 3156407) [Leaf (Rect (Pt 2074 6391) (Pt 2479 7926)) (LHV 3156407) [Info (Rect (Pt 2074 6576) (Pt 2184 6601)) (LHV 3151494) "2184,6576,2184,6601,2074,6601,2074,6576",Info (Rect (Pt 2132 7879) (Pt 2167 7926)) (LHV 3156407) "2167,7926,2167,7879,2132,7879,2132,7926",Info (Rect (Pt 2318 6391) (Pt 2479 6418)) (LHV 3151769) "2479,6391,2479,6418,2318,6418,2318,6391"]]]],Branch (Rect (Pt 2401 6262) (Pt 3765 6289)) (LHV 3146572) [Branch (Rect (Pt 2401 6262) (Pt 3765 6289)) (LHV 3146572) [Branch (Rect (Pt 2401 6262) (Pt 3765 6289)) (LHV 3146572) [Leaf (Rect (Pt 2401 6262) (Pt 3765 6289)) (LHV 3146572) [Info (Rect (Pt 2401 6262) (Pt 3765 6289)) (LHV 3146572) "2401,6289,2401,6264,3765,6262,3765,6287"]]]]],Branch (Rect (Pt 2376 7311) (Pt 4220 7807)) (LHV 3161048) [Branch (Rect (Pt 2376 7311) (Pt 4220 7807)) (LHV 3161048) [Branch (Rect (Pt 2376 7311) (Pt 4220 7807)) (LHV 3161048) [Branch (Rect (Pt 2376 7311) (Pt 4220 7807)) (LHV 3161048) [Leaf (Rect (Pt 3679 7311) (Pt 4220 7618)) (LHV 3159552) [Info (Rect (Pt 3679 7311) (Pt 3883 7337)) (LHV 3159552) "3883,7311,3883,7337,3679,7337,3679,7311",Info (Rect (Pt 3948 7584) (Pt 4220 7618)) (LHV 3159251) "4220,7584,4220,7618,3948,7618,3948,7584"],Leaf (Rect (Pt 2376 7523) (Pt 3383 7807)) (LHV 3161048) [Info (Rect (Pt 2376 7758) (Pt 2411 7807)) (LHV 3155985) "2411,7807,2411,7758,2376,7758,2376,7807",Info (Rect (Pt 2836 7523) (Pt 3383 7549)) (LHV 3161048) "2836,7549,2836,7523,3383,7523,3383,7549"]]]]]],Branch (Rect (Pt 476 965) (Pt 7752 7477)) (LHV 3406177) [Branch (Rect (Pt 1953 4187) (Pt 4601 7180)) (LHV 3171297) [Branch (Rect (Pt 1953 4187) (Pt 4601 7180)) (LHV 3171297) [Branch (Rect (Pt 1953 6264) (Pt 4050 7180)) (LHV 3152503) [Branch (Rect (Pt 1953 6264) (Pt 4050 7180)) (LHV 3152503) [Leaf (Rect (Pt 1953 6264) (Pt 3895 6826)) (LHV 3151234) [Info (Rect (Pt 1953 6264) (Pt 2324 6289)) (LHV 3151234) "1953,6289,1953,6264,2324,6264,2324,6289",Info (Rect (Pt 3031 6532) (Pt 3157 6557)) (LHV 3145969) "3031,6557,3031,6532,3157,6532,3157,6557",Info (Rect (Pt 3037 6801) (Pt 3895 6826)) (LHV 3147755) "3037,6826,3037,6801,3895,6801,3895,6826"],Leaf (Rect (Pt 2116 6994) (Pt 2194 7014)) (LHV 3152503) [Info (Rect (Pt 2116 6994) (Pt 2194 7014)) (LHV 3152503) "2116,7014,2116,6994,2194,6994,2194,7014"],Leaf (Rect (Pt 3985 7150) (Pt 4050 7180)) (LHV 3148442) [Info (Rect (Pt 3985 7150) (Pt 4050 7180)) (LHV 3148442) "3985,7180,3985,7150,4050,7150,4050,7180"]]],Branch (Rect (Pt 2188 4187) (Pt 4601 7016)) (LHV 3171025) [Branch (Rect (Pt 2188 4318) (Pt 4601 7016)) (LHV 3170952) [Leaf (Rect (Pt 2188 5279) (Pt 4601 5444)) (LHV 3163257) [Info (Rect (Pt 2188 5279) (Pt 4601 5309)) (LHV 3163257) "2188,5309,2188,5284,4601,5279,4601,5305",Info (Rect (Pt 3717 5420) (Pt 4013 5444)) (LHV 3162678) "3717,5444,3717,5420,4013,5420,4013,5444"],Leaf (Rect (Pt 2227 6992) (Pt 2981 7016)) (LHV 3153886) [Info (Rect (Pt 2227 6992) (Pt 2981 7016)) (LHV 3153886) "2227,7016,2227,6992,2981,6992,2981,7016"],Leaf (Rect (Pt 2634 4318) (Pt 3735 5446)) (LHV 3170952) [Info (Rect (Pt 2634 5014) (Pt 2709 5036)) (LHV 3170952) "2634,5036,2634,5014,2709,5014,2709,5036",Info (Rect (Pt 3128 5421) (Pt 3688 5446)) (LHV 3164060) "3128,5446,3128,5421,3688,5421,3688,5446",Info (Rect (Pt 3300 4318) (Pt 3735 4341)) (LHV 3168557) "3300,4341,3300,4318,3735,4318,3735,4341"]],Branch (Rect (Pt 2750 5013) (Pt 2825 5035)) (LHV 3171025) [Leaf (Rect (Pt 2750 5013) (Pt 2825 5035)) (LHV 3171025) [Info (Rect (Pt 2750 5013) (Pt 2825 5035)) (LHV 3171025) "2750,5035,2750,5013,2825,5013,2825,5035"]],Branch (Rect (Pt 3273 4187) (Pt 3721 4212)) (LHV 3168631) [Leaf (Rect (Pt 3273 4187) (Pt 3721 4212)) (LHV 3168631) [Info (Rect (Pt 3273 4187) (Pt 3721 4212)) (LHV 3168631) "3273,4212,3273,4187,3721,4187,3721,4212"]]],Branch (Rect (Pt 2867 5014) (Pt 2943 5036)) (LHV 3171297) [Branch (Rect (Pt 2867 5014) (Pt 2943 5036)) (LHV 3171297) [Leaf (Rect (Pt 2867 5014) (Pt 2943 5036)) (LHV 3171297) [Info (Rect (Pt 2867 5014) (Pt 2943 5036)) (LHV 3171297) "2867,5036,2867,5014,2943,5014,2943,5036"]]]]],Branch (Rect (Pt 476 965) (Pt 7752 7477)) (LHV 3406177) [Branch (Rect (Pt 476 965) (Pt 7752 7477)) (LHV 3406177) [Branch (Rect (Pt 476 4189) (Pt 7710 7477)) (LHV 3237713) [Branch (Rect (Pt 476 4189) (Pt 6125 7477)) (LHV 3223503) [Leaf (Rect (Pt 649 4189) (Pt 3255 6876)) (LHV 3210147) [Info (Rect (Pt 649 6848) (Pt 997 6876)) (LHV 3210147) "997,6848,997,6876,649,6876,649,6848",Info (Rect (Pt 2542 5421) (Pt 2929 5447)) (LHV 3176546) "2542,5447,2542,5421,2929,5421,2929,5447",Info (Rect (Pt 2830 4189) (Pt 3255 4212)) (LHV 3171662) "2830,4212,2830,4189,3255,4189,3255,4212"],Leaf (Rect (Pt 476 5422) (Pt 2339 7477)) (LHV 3208895) [Info (Rect (Pt 476 6725) (Pt 502 7477)) (LHV 3208895) "502,6725,502,7477,476,7477,476,6725",Info (Rect (Pt 1876 5422) (Pt 2339 5447)) (LHV 3177786) "2339,5422,2339,5447,1876,5447,1876,5422"],Leaf (Rect (Pt 4255 6663) (Pt 6125 7096)) (LHV 3223503) [Info (Rect (Pt 4255 6663) (Pt 4427 6695)) (LHV 3223503) "4255,6663,4255,6695,4427,6695,4427,6663",Info (Rect (Pt 5921 7071) (Pt 6125 7096)) (LHV 3216153) "5921,7096,5921,7071,6125,7071,6125,7096"]],Branch (Rect (Pt 7292 6500) (Pt 7710 7332)) (LHV 3237713) [Leaf (Rect (Pt 7292 6500) (Pt 7710 7332)) (LHV 3237713) [Info (Rect (Pt 7292 7225) (Pt 7317 7332)) (LHV 3234959) "7292,7332,7292,7225,7317,7225,7317,7332",Info (Rect (Pt 7686 6500) (Pt 7710 7249)) (LHV 3237713) "7710,6500,7710,7249,7686,7249,7686,6500"]],Branch (Rect (Pt 649 6803) (Pt 999 6832)) (LHV 3210141) [Leaf (Rect (Pt 649 6803) (Pt 999 6832)) (LHV 3210141) [Info (Rect (Pt 649 6803) (Pt 999 6832)) (LHV 3210141) "649,6832,649,6803,999,6803,999,6832"]]],Branch (Rect (Pt 1292 5857) (Pt 7752 7250)) (LHV 3270705) [Branch (Rect (Pt 1292 6388) (Pt 4410 7018)) (LHV 3222460) [Leaf (Rect (Pt 1292 6388) (Pt 4410 7018)) (LHV 3222460) [Info (Rect (Pt 1292 6992) (Pt 1761 7018)) (LHV 3203119) "1292,7018,1292,6992,1761,6992,1761,7018",Info (Rect (Pt 4146 6388) (Pt 4410 6416)) (LHV 3222460) "4410,6388,4410,6416,4146,6416,4146,6388"]],Branch (Rect (Pt 2537 5857) (Pt 7752 7250)) (LHV 3270705) [Leaf (Rect (Pt 2537 5993) (Pt 3000 6017)) (LHV 3175499) [Info (Rect (Pt 2537 5993) (Pt 3000 6017)) (LHV 3175499) "2537,6017,2537,5993,3000,5993,3000,6017"],Leaf (Rect (Pt 6654 6299) (Pt 7084 6324)) (LHV 3243486) [Info (Rect (Pt 6654 6299) (Pt 7084 6324)) (LHV 3243486) "6654,6324,6654,6299,7084,6299,7084,6324"],Leaf (Rect (Pt 4934 5857) (Pt 7752 7250)) (LHV 3270705) [Info (Rect (Pt 4934 5857) (Pt 6382 5884)) (LHV 3270705) "4934,5884,4934,5860,6382,5857,6382,5882",Info (Rect (Pt 7727 6103) (Pt 7752 7250)) (LHV 3237695) "7727,7250,7727,6103,7752,6103,7752,7250"]]],Branch (Rect (Pt 1471 965) (Pt 6312 4115)) (LHV 3406177) [Branch (Rect (Pt 1471 965) (Pt 6312 4115)) (LHV 3351755) [Leaf (Rect (Pt 1471 965) (Pt 5793 4115)) (LHV 3351755) [Info (Rect (Pt 1471 965) (Pt 1614 993)) (LHV 3351755) "1471,993,1471,965,1614,965,1614,993",Info (Rect (Pt 5059 1090) (Pt 5793 1115)) (LHV 3334876) "5059,1115,5059,1090,5793,1090,5793,1115",Info (Rect (Pt 5273 4086) (Pt 5397 4115)) (LHV 3274036) "5273,4115,5273,4086,5397,4086,5397,4115"],Leaf (Rect (Pt 4274 1048) (Pt 4946 1074)) (LHV 3333465) [Info (Rect (Pt 4274 1048) (Pt 4946 1074)) (LHV 3333465) "4274,1074,4274,1048,4946,1048,4946,1074"],Leaf (Rect (Pt 6177 1366) (Pt 6312 1393)) (LHV 3312616) [Info (Rect (Pt 6177 1366) (Pt 6312 1393)) (LHV 3312616) "6177,1393,6177,1366,6312,1366,6312,1393"]],Branch (Rect (Pt 2628 2456) (Pt 4148 4056)) (LHV 3389213) [Leaf (Rect (Pt 2628 2456) (Pt 4148 4056)) (LHV 3389213) [Info (Rect (Pt 2628 2937) (Pt 2740 2967)) (LHV 3376362) "2628,2967,2628,2937,2740,2937,2740,2967",Info (Rect (Pt 3359 4030) (Pt 4148 4056)) (LHV 3385757) "3359,4056,3359,4030,4148,4030,4148,4056",Info (Rect (Pt 3458 2456) (Pt 3570 2482)) (LHV 3389213) "3458,2482,3458,2456,3570,2456,3570,2482"]],Branch (Rect (Pt 2625 1049) (Pt 5396 3348)) (LHV 3406177) [Leaf (Rect (Pt 2625 1049) (Pt 5396 3348)) (LHV 3406177) [Info (Rect (Pt 2625 1746) (Pt 2738 1776)) (LHV 3403478) "2625,1776,2625,1746,2738,1746,2738,1776",Info (Rect (Pt 2792 1049) (Pt 4212 1076)) (LHV 3406177) "2792,1076,2792,1052,4212,1049,4212,1073",Info (Rect (Pt 5274 3322) (Pt 5396 3348)) (LHV 3278388) "5274,3348,5274,3322,5396,3322,5396,3348"]]]]]]])


*Main> length $ searchHRT (Rect (Pt 0 0) (Pt 65535 65535)) (hrtFromCoordList rs) 
58


NOTE: in bash, the printed HRT for hrtFromCoordList is, indeed, only 58 items...








*Main> let hrt0 = hrtFromCoordList rs


*Main> map (\cs -> filter (==cs) $ hrtSearchWithCoord cs hrt0) rs
[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["2167,7926,2167,7879,2132,7879,2132,7926"],[],[],[],[],[],[],["2411,7807,2411,7758,2376,7758,2376,7807"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["2116,7014,2116,6994,2194,6994,2194,7014"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["2867,5036,2867,5014,2943,5014,2943,5036"],["2750,5035,2750,5013,2825,5013,2825,5035"],["2634,5036,2634,5014,2709,5014,2709,5036"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["3985,7180,3985,7150,4050,7150,4050,7180"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["1953,6289,1953,6264,2324,6264,2324,6289"],[],[],[],[],[],[],["2401,6289,2401,6264,3765,6262,3765,6287"],[],[],["3273,4212,3273,4187,3721,4187,3721,4212"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["1965,6375,1965,6350,2509,6350,2509,6375"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["2227,7016,2227,6992,2981,6992,2981,7016"],["3031,6557,3031,6532,3157,6532,3157,6557"],[],[],[],[],[],[],[],["3048,6971,3048,6947,3793,6947,3793,6971"],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],["3883,7311,3883,7337,3679,7337,3679,7311"],[],[],["3037,6826,3037,6801,3895,6801,3895,6826"],[],["2528,6558,2528,6526,2681,6526,2681,6558"],[],[],[],[],[],[],[],[],["2541,6417,2541,6390,2780,6390,2780,6417"],[],[],[],["2836,7549,2836,7523,3383,7523,3383,7549"],[],[],[],[],[],[],["2184,6576,2184,6601,2074,6601,2074,6576"],[],[],[],[],[],[],["4113,7123,4113,7149,3406,7149,3406,7123"],["2188,5309,2188,5284,4601,5279,4601,5305"],[],["2844,6464,2844,6440,2992,6440,2992,6464"],[],[],[],[],[],[],[],[],[],[],[],["3031,6459,3031,6435,3420,6435,3420,6459"],[],["2479,6391,2479,6418,2318,6418,2318,6391"],[],[],["649,6832,649,6803,999,6803,999,6832"],[],[],[],[],["7710,6500,7710,7249,7686,7249,7686,6500"],["3300,4341,3300,4318,3735,4318,3735,4341"],[],["3128,5446,3128,5421,3688,5421,3688,5446"],[],[],["4410,6388,4410,6416,4146,6416,4146,6388"],[],[],["2537,6017,2537,5993,3000,5993,3000,6017"],[],[],[],[],[],[],[],["3536,6555,3536,6530,3760,6530,3760,6555"],["1471,993,1471,965,1614,965,1614,993"],[],[],[],["4233,6937,4233,6971,3888,6971,3888,6937"],[],[],[],["4255,6663,4255,6695,4427,6695,4427,6663"],["502,6725,502,7477,476,7477,476,6725"],["997,6848,997,6876,649,6876,649,6848"],["2339,5422,2339,5447,1876,5447,1876,5422"],["6654,6324,6654,6299,7084,6299,7084,6324"],[],["5921,7096,5921,7071,6125,7071,6125,7096"],["4220,7584,4220,7618,3948,7618,3948,7584"],[],[],[],[],[],["5274,3348,5274,3322,5396,3322,5396,3348"],[],[],[],["7292,7332,7292,7225,7317,7225,7317,7332"],[],["3458,2482,3458,2456,3570,2456,3570,2482"],["2625,1776,2625,1746,2738,1746,2738,1776"],["2830,4212,2830,4189,3255,4189,3255,4212"],["3359,4056,3359,4030,4148,4030,4148,4056"],["6177,1393,6177,1366,6312,1366,6312,1393"],["2542,5447,2542,5421,2929,5421,2929,5447"],["2792,1076,2792,1052,4212,1049,4212,1073"],["4274,1074,4274,1048,4946,1048,4946,1074"],["5059,1115,5059,1090,5793,1090,5793,1115"],["2628,2967,2628,2937,2740,2937,2740,2967"],["3717,5444,3717,5420,4013,5420,4013,5444"],["7727,7250,7727,6103,7752,6103,7752,7250"],[],["4934,5884,4934,5860,6382,5857,6382,5882"],["1292,7018,1292,6992,1761,6992,1761,7018"],["5273,4115,5273,4086,5397,4086,5397,4115"]]




*Main> let whatIsHappening xxx = length $ map (\cs -> filter (==cs) $ hrtSearchWithCoord cs (hrtFromCoordList $ take xxx rs)) $ take xxx rs
*Main> 
*Main> whatIsHappening 1
1
*Main> whatIsHappening 1000
1000
*Main> whatIsHappening 200000
1454
*Main> 


BUT I THOUGHT I HAD A PROBLEM??


*Main> map (\cs -> filter (==cs) $ hrtSearchWithCoord cs hrt0) $ take 10 rs
[[],[],[],[],[],[],[],[],[],[]]
*Main> 
*Main> 
*Main> let hrt0 = hrtFromCoordList rs
*Main> 
*Main> 
*Main> map (\cs -> filter (==cs) $ hrtSearchWithCoord cs (hrtFromCoordList rs)) $ take 10 rs
[[],[],[],[],[],[],[],[],[],[]]
*Main> 
*Main> 



OK.


IMPROVED, SHOWING THE PROBLEM, OR PART OF IT:


*Main> let whatIsHappening xxx = filter (\x -> length x > 0) $ map (\cs -> filter (==cs) $ hrtSearchWithCoord cs (hrtFromCoordList $ take xxx rs)) $ take xxx rs 
*Main> 
*Main> 
*Main> let whatIsHappening' x = (length . whatIsHappening $ x, whatIsHappening x)
*Main> 
*Main> 
*Main> whatIsHappening' 1
(1,[["5391,8260,5391,8216,5357,8216,5357,8260"]])
*Main> whatIsHappening' 2
(2,[["5391,8260,5391,8216,5357,8216,5357,8260"],["5391,7919,5391,7873,5356,7873,5356,7919"]])
*Main> whatIsHappening' 3
(3,[["5391,8260,5391,8216,5357,8216,5357,8260"],["5391,7919,5391,7873,5356,7873,5356,7919"],["5392,7804,5392,7757,5357,7757,5357,7804"]])
*Main> whatIsHappening' 4
(4,[["5391,8260,5391,8216,5357,8216,5357,8260"],["5391,7919,5391,7873,5356,7873,5356,7919"],["5392,7804,5392,7757,5357,7757,5357,7804"],["5390,8144,5390,8101,5356,8101,5356,8144"]])
*Main> whatIsHappening' 5
(5,[["5391,8260,5391,8216,5357,8216,5357,8260"],["5391,7919,5391,7873,5356,7873,5356,7919"],["5392,7804,5392,7757,5357,7757,5357,7804"],["5390,8144,5390,8101,5356,8101,5356,8144"],["5391,8493,5391,8447,5357,8447,5357,8493"]])
*Main> whatIsHappening' 6
(3,[["5391,7919,5391,7873,5356,7873,5356,7919"],["5392,7804,5392,7757,5357,7757,5357,7804"],["5392,8377,5392,8332,5357,8333,5357,8377"]])
*Main> 



*Main> hrtFromCoordList $ take 1 rs
Root 
(Leaf (Rect (Pt 5357 8216) (Pt 5391 8260)) (LHV 3621835) [Info (Rect (Pt 5357 8216) (Pt 5391 8260)) (LHV 3621835) "5391,8260,5391,8216,5357,8216,5357,8260"])


*Main> hrtFromCoordList $ take 5 rs
Root (
Branch (Rect (Pt 5356 7757) (Pt 5392 8493)) (LHV 3621835) [
	Leaf (Rect (Pt 5356 7873) (Pt 5391 7919)) (LHV 3213762) [
		Info (Rect (Pt 5356 7873) (Pt 5391 7919)) (LHV 3213762) "5391,7919,5391,7873,5356,7873,5356,7919"],
	Leaf (Rect (Pt 5357 7757) (Pt 5392 7804)) (LHV 3213611) [
		Info (Rect (Pt 5357 7757) (Pt 5392 7804)) (LHV 3213611) "5392,7804,5392,7757,5357,7757,5357,7804"],
	Leaf (Rect (Pt 5356 8101) (Pt 5391 8493)) (LHV 3621835) [
		Info (Rect (Pt 5356 8101) (Pt 5390 8144)) (LHV 3214035) "5390,8144,5390,8101,5356,8101,5356,8144",
		Info (Rect (Pt 5357 8216) (Pt 5391 8260)) (LHV 3621835) "5391,8260,5391,8216,5357,8216,5357,8260",
		Info (Rect (Pt 5357 8447) (Pt 5391 8493)) (LHV 3620948) "5391,8493,5391,8447,5357,8447,5357,8493"]])
*Main> 
*Main> 
*Main> hrtFromCoordList $ take 6 rs
Root (
Branch (Rect (Pt 5356 7757) (Pt 5392 8377)) (LHV 3621821) [
	Leaf (Rect (Pt 5357 7757) (Pt 5392 7804)) (LHV 3213611) [
		Info (Rect (Pt 5357 7757) (Pt 5392 7804)) (LHV 3213611) "5392,7804,5392,7757,5357,7757,5357,7804"],
	Leaf (Rect (Pt 5356 7873) (Pt 5392 8377)) (LHV 3621821) [
		Info (Rect (Pt 5356 7873) (Pt 5391 7919)) (LHV 3213762) "5391,7919,5391,7873,5356,7873,5356,7919",
		Info (Rect (Pt 5357 8332) (Pt 5392 8377)) (LHV 3621821) "5392,8377,5392,8332,5357,8333,5357,8377"]])
*Main> 


*Main> take 6 rs
["5391,8260,5391,8216,5357,8216,5357,8260"
,"5391,7919,5391,7873,5356,7873,5356,7919"
,"5392,7804,5392,7757,5357,7757,5357,7804"
,"5390,8144,5390,8101,5356,8101,5356,8144"
,"5391,8493,5391,8447,5357,8447,5357,8493"
,"5392,8377,5392,8332,5357,8333,5357,8377"]



OK, so now I've maybe fixed it to avoid dropping nonSibling trees.

And after meeting an infinite loop, made sure that 
after inserting a new tree, insertion will succeed,
by making all the peers siblings, anyways.

now...  

*Main> let hrt0 = hrtFromCoordList rs
*Main> let srch0 = flip hrtSearchWithCoord hrt0
*Main> length $ filter (\x -> length x > 0) $ map (\cs -> filter (==cs) $ srch0 cs) rs
1454
*Main> 



We're back in business...





